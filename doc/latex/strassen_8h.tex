\hypertarget{strassen_8h}{}\doxysection{core/sat/native/mini/maple\+C\+O\+M\+S\+P\+S/m4ri-\/20140914/m4ri/strassen.h File Reference}
\label{strassen_8h}\index{core/sat/native/mini/mapleCOMSPS/m4ri-\/20140914/m4ri/strassen.h@{core/sat/native/mini/mapleCOMSPS/m4ri-\/20140914/m4ri/strassen.h}}


Matrix operations using Strassen\textquotesingle{}s formulas including Winograd\textquotesingle{}s improvements.  


{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include $<$m4ri/mzd.\+h$>$}\newline
{\ttfamily \#include $<$m4ri/brilliantrussian.\+h$>$}\newline
Include dependency graph for strassen.\+h\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{strassen_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=249pt]{strassen_8h__dep__incl}
\end{center}
\end{figure}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{strassen_8h_a574fda6cd10fea803ec5b211dbcac4bc}{\+\_\+\+\_\+\+M4\+R\+I\+\_\+\+S\+T\+R\+A\+S\+S\+E\+N\+\_\+\+M\+U\+L\+\_\+\+C\+U\+T\+O\+FF}}~\mbox{\hyperlink{misc_8h_a74e75242132eaabbc1c512488a135926}{M\+IN}}(((int) sqrt((double) (4 $\ast$ \+\_\+\+\_\+\+M4\+R\+I\+\_\+\+C\+P\+U\+\_\+\+L3\+\_\+\+C\+A\+C\+HE))), 4096)
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} $\ast$ \mbox{\hyperlink{strassen_8h_a7032dd2b60b0cfc9a8c4dd2faddf5065}{mzd\+\_\+mul}} (\mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} $\ast$C, \mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} const $\ast$A, \mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} const $\ast$B, int cutoff)
\begin{DoxyCompactList}\small\item\em Matrix multiplication via the Strassen-\/\+Winograd matrix multiplication algorithm, i.\+e. compute C = AB. \end{DoxyCompactList}\item 
\mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} $\ast$ \mbox{\hyperlink{strassen_8h_a2dd6c4982d73d9d27c01d3b0f9249304}{mzd\+\_\+addmul}} (\mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} $\ast$C, \mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} const $\ast$A, \mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} const $\ast$B, int cutoff)
\begin{DoxyCompactList}\small\item\em Matrix multiplication and in-\/place addition via the Strassen-\/\+Winograd matrix multiplication algorithm, i.\+e. compute C = C+ AB. \end{DoxyCompactList}\item 
\mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} $\ast$ \mbox{\hyperlink{strassen_8h_a8432a43d231b2aeaf118d21b35d817ce}{\+\_\+mzd\+\_\+mul\+\_\+even}} (\mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} $\ast$C, \mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} const $\ast$A, \mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} const $\ast$B, int cutoff)
\begin{DoxyCompactList}\small\item\em Matrix multiplication via the Strassen-\/\+Winograd matrix multiplication algorithm, i.\+e. compute C = AB. \end{DoxyCompactList}\item 
\mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} $\ast$ \mbox{\hyperlink{strassen_8h_a6ad9c4c4d3ab2ec65f610a17d66cebb0}{\+\_\+mzd\+\_\+addmul\+\_\+even}} (\mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} $\ast$C, \mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} const $\ast$A, \mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} const $\ast$B, int cutoff)
\begin{DoxyCompactList}\small\item\em Matrix multiplication and in-\/place addition via the Strassen-\/\+Winograd matrix multiplication algorithm, i.\+e. compute C = C+ AB. \end{DoxyCompactList}\item 
\mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} $\ast$ \mbox{\hyperlink{strassen_8h_a9d3535d8c88c5182a494bbe3d47fdde7}{\+\_\+mzd\+\_\+addmul}} (\mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} $\ast$C, \mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} const $\ast$A, \mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} const $\ast$B, int cutoff)
\begin{DoxyCompactList}\small\item\em Matrix multiplication and in-\/place addition via the Strassen-\/\+Winograd matrix multiplication algorithm, i.\+e. compute C = C + AB. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Matrix operations using Strassen\textquotesingle{}s formulas including Winograd\textquotesingle{}s improvements. 

\begin{DoxyAuthor}{Author}
Gregory Bard \href{mailto:bard@fordham.edu}{\texttt{ bard@fordham.\+edu}} 

Martin Albrecht \href{mailto:M.R.Albrecht@rhul.ac.uk}{\texttt{ M.\+R.\+Albrecht@rhul.\+ac.\+uk}} 
\end{DoxyAuthor}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{strassen_8h_a574fda6cd10fea803ec5b211dbcac4bc}\label{strassen_8h_a574fda6cd10fea803ec5b211dbcac4bc}} 
\index{strassen.h@{strassen.h}!\_\_M4RI\_STRASSEN\_MUL\_CUTOFF@{\_\_M4RI\_STRASSEN\_MUL\_CUTOFF}}
\index{\_\_M4RI\_STRASSEN\_MUL\_CUTOFF@{\_\_M4RI\_STRASSEN\_MUL\_CUTOFF}!strassen.h@{strassen.h}}
\doxysubsubsection{\texorpdfstring{\_\_M4RI\_STRASSEN\_MUL\_CUTOFF}{\_\_M4RI\_STRASSEN\_MUL\_CUTOFF}}
{\footnotesize\ttfamily \#define \+\_\+\+\_\+\+M4\+R\+I\+\_\+\+S\+T\+R\+A\+S\+S\+E\+N\+\_\+\+M\+U\+L\+\_\+\+C\+U\+T\+O\+FF~\mbox{\hyperlink{misc_8h_a74e75242132eaabbc1c512488a135926}{M\+IN}}(((int) sqrt((double) (4 $\ast$ \+\_\+\+\_\+\+M4\+R\+I\+\_\+\+C\+P\+U\+\_\+\+L3\+\_\+\+C\+A\+C\+HE))), 4096)}

The default cutoff for Strassen-\/\+Winograd multiplication. It should hold hold that 2 $\ast$ (n$^\wedge$2)/8 fits into the L2 cache. 

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{strassen_8h_a9d3535d8c88c5182a494bbe3d47fdde7}\label{strassen_8h_a9d3535d8c88c5182a494bbe3d47fdde7}} 
\index{strassen.h@{strassen.h}!\_mzd\_addmul@{\_mzd\_addmul}}
\index{\_mzd\_addmul@{\_mzd\_addmul}!strassen.h@{strassen.h}}
\doxysubsubsection{\texorpdfstring{\_mzd\_addmul()}{\_mzd\_addmul()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}}$\ast$ \+\_\+mzd\+\_\+addmul (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} $\ast$}]{C,  }\item[{\mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} const $\ast$}]{A,  }\item[{\mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} const $\ast$}]{B,  }\item[{int}]{cutoff }\end{DoxyParamCaption})}



Matrix multiplication and in-\/place addition via the Strassen-\/\+Winograd matrix multiplication algorithm, i.\+e. compute C = C + AB. 

The matrices A and B are respectively m x k and k x n, and can be not aligned on the m4ri\+\_\+radix grid.


\begin{DoxyParams}{Parameters}
{\em C} & Preallocated product matrix, may be N\+U\+LL for automatic creation. \\
\hline
{\em A} & Input matrix A \\
\hline
{\em B} & Input matrix B \\
\hline
{\em cutoff} & Minimal dimension for Strassen recursion. \\
\hline
\end{DoxyParams}
Assumes that B and C are aligned in the same manner (as in a Schur complement)\mbox{\Hypertarget{strassen_8h_a6ad9c4c4d3ab2ec65f610a17d66cebb0}\label{strassen_8h_a6ad9c4c4d3ab2ec65f610a17d66cebb0}} 
\index{strassen.h@{strassen.h}!\_mzd\_addmul\_even@{\_mzd\_addmul\_even}}
\index{\_mzd\_addmul\_even@{\_mzd\_addmul\_even}!strassen.h@{strassen.h}}
\doxysubsubsection{\texorpdfstring{\_mzd\_addmul\_even()}{\_mzd\_addmul\_even()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}}$\ast$ \+\_\+mzd\+\_\+addmul\+\_\+even (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} $\ast$}]{C,  }\item[{\mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} const $\ast$}]{A,  }\item[{\mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} const $\ast$}]{B,  }\item[{int}]{cutoff }\end{DoxyParamCaption})}



Matrix multiplication and in-\/place addition via the Strassen-\/\+Winograd matrix multiplication algorithm, i.\+e. compute C = C+ AB. 

This is the actual implementation. Any matrix where either the number of rows or the number of columns is smaller than cutoff is processed using the M4\+RM algorithm.


\begin{DoxyParams}{Parameters}
{\em C} & Preallocated product matrix, may be N\+U\+LL for automatic creation. \\
\hline
{\em A} & Input matrix A \\
\hline
{\em B} & Input matrix B \\
\hline
{\em cutoff} & Minimal dimension for Strassen recursion.\\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
This implementation is heavily inspired by the function strassen\+\_\+window\+\_\+multiply\+\_\+c in Sage 3.\+0; For reference see \href{http://www.sagemath.org}{\texttt{ http\+://www.\+sagemath.\+org}} 
\end{DoxyNote}
\begin{DoxyRefDesc}{Todo}
\item[\mbox{\hyperlink{todo__todo000012}{Todo}}]make sure not to overwrite crap after ncols and before width $\ast$ m4ri\+\_\+radix \end{DoxyRefDesc}


\begin{DoxyNote}{Note}
See Marco Bodrato; \char`\"{}\+A Strassen-\/like Matrix Multiplication
\+Suited for Squaring and Highest Power Computation\char`\"{}; \href{http://bodrato.it/papres/\#CIVV2008}{\texttt{ http\+://bodrato.\+it/papres/\#\+C\+I\+V\+V2008}} for reference on the used sequence of operations.
\end{DoxyNote}
\mbox{\Hypertarget{strassen_8h_a8432a43d231b2aeaf118d21b35d817ce}\label{strassen_8h_a8432a43d231b2aeaf118d21b35d817ce}} 
\index{strassen.h@{strassen.h}!\_mzd\_mul\_even@{\_mzd\_mul\_even}}
\index{\_mzd\_mul\_even@{\_mzd\_mul\_even}!strassen.h@{strassen.h}}
\doxysubsubsection{\texorpdfstring{\_mzd\_mul\_even()}{\_mzd\_mul\_even()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}}$\ast$ \+\_\+mzd\+\_\+mul\+\_\+even (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} $\ast$}]{C,  }\item[{\mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} const $\ast$}]{A,  }\item[{\mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} const $\ast$}]{B,  }\item[{int}]{cutoff }\end{DoxyParamCaption})}



Matrix multiplication via the Strassen-\/\+Winograd matrix multiplication algorithm, i.\+e. compute C = AB. 

This is the actual implementation. Any matrix where either the number of rows or the number of columns is smaller than cutoff is processed using the M4\+RM algorithm.


\begin{DoxyParams}{Parameters}
{\em C} & Preallocated product matrix, may be N\+U\+LL for automatic creation. \\
\hline
{\em A} & Input matrix A \\
\hline
{\em B} & Input matrix B \\
\hline
{\em cutoff} & Minimal dimension for Strassen recursion.\\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
This implementation is heavily inspired by the function strassen\+\_\+window\+\_\+multiply\+\_\+c in Sage 3.\+0; For reference see \href{http://www.sagemath.org}{\texttt{ http\+://www.\+sagemath.\+org}} 
\end{DoxyNote}
\begin{DoxyNote}{Note}
See Marco Bodrato; \char`\"{}\+A Strassen-\/like Matrix Multiplication
\+Suited for Squaring and Highest Power Computation\char`\"{}; \href{http://bodrato.it/papres/\#CIVV2008}{\texttt{ http\+://bodrato.\+it/papres/\#\+C\+I\+V\+V2008}} for reference on the used sequence of operations.
\end{DoxyNote}
\begin{DoxyRefDesc}{Todo}
\item[\mbox{\hyperlink{todo__todo000011}{Todo}}]ideally we would use the same Wmk throughout the function but some called function doesn\textquotesingle{}t like that and we end up with a wrong result if we use virtual Wmk matrices. Ideally, this should be fixed not worked around. The check whether the bug has been fixed, use only one Wmk and check if mzd\+\_\+mul(4096, 3528, 4096, 2124) still returns the correct answer. \end{DoxyRefDesc}
\mbox{\Hypertarget{strassen_8h_a2dd6c4982d73d9d27c01d3b0f9249304}\label{strassen_8h_a2dd6c4982d73d9d27c01d3b0f9249304}} 
\index{strassen.h@{strassen.h}!mzd\_addmul@{mzd\_addmul}}
\index{mzd\_addmul@{mzd\_addmul}!strassen.h@{strassen.h}}
\doxysubsubsection{\texorpdfstring{mzd\_addmul()}{mzd\_addmul()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}}$\ast$ mzd\+\_\+addmul (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} $\ast$}]{C,  }\item[{\mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} const $\ast$}]{A,  }\item[{\mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} const $\ast$}]{B,  }\item[{int}]{cutoff }\end{DoxyParamCaption})}



Matrix multiplication and in-\/place addition via the Strassen-\/\+Winograd matrix multiplication algorithm, i.\+e. compute C = C+ AB. 

This is the wrapper function including bounds checks. See \+\_\+mzd\+\_\+addmul\+\_\+even for implementation details.


\begin{DoxyParams}{Parameters}
{\em C} & product matrix \\
\hline
{\em A} & Input matrix A \\
\hline
{\em B} & Input matrix B \\
\hline
{\em cutoff} & Minimal dimension for Strassen recursion. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{strassen_8h_a7032dd2b60b0cfc9a8c4dd2faddf5065}\label{strassen_8h_a7032dd2b60b0cfc9a8c4dd2faddf5065}} 
\index{strassen.h@{strassen.h}!mzd\_mul@{mzd\_mul}}
\index{mzd\_mul@{mzd\_mul}!strassen.h@{strassen.h}}
\doxysubsubsection{\texorpdfstring{mzd\_mul()}{mzd\_mul()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}}$\ast$ mzd\+\_\+mul (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} $\ast$}]{C,  }\item[{\mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} const $\ast$}]{A,  }\item[{\mbox{\hyperlink{structmzd__t}{mzd\+\_\+t}} const $\ast$}]{B,  }\item[{int}]{cutoff }\end{DoxyParamCaption})}



Matrix multiplication via the Strassen-\/\+Winograd matrix multiplication algorithm, i.\+e. compute C = AB. 

This is the wrapper function including bounds checks. See \+\_\+mzd\+\_\+mul\+\_\+even for implementation details.


\begin{DoxyParams}{Parameters}
{\em C} & Preallocated product matrix, may be N\+U\+LL for automatic creation. \\
\hline
{\em A} & Input matrix A \\
\hline
{\em B} & Input matrix B \\
\hline
{\em cutoff} & Minimal dimension for Strassen recursion. \\
\hline
\end{DoxyParams}
